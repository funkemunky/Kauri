package dev.brighten.anticheat.check.impl.packet.exploits;

import cc.funkemunky.api.tinyprotocol.packet.in.WrappedInChatPacket;
import dev.brighten.anticheat.check.api.Check;
import dev.brighten.anticheat.check.api.CheckInfo;
import dev.brighten.anticheat.check.api.Packet;
import dev.brighten.api.check.CheckType;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

@CheckInfo(name = "Log4J", description = "Patched Log4J exploit on your players.", checkType = CheckType.EXPLOIT)
public class Log4JPatch extends Check {

    private Pattern pattern = Pattern.compile("\\$\\{.*}");
    @Packet
    public boolean onChat(WrappedInChatPacket packet) {
        Matcher matcher = pattern.matcher(packet.getMessage());
        if(matcher.matches()) {
            vl++;
            flag("Tried to use JNDI exploit");
            return true;
        }
        return false;
    }
}
