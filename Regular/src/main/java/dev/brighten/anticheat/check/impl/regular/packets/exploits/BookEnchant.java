package dev.brighten.anticheat.check.impl.regular.packets.exploits;

import dev.brighten.anticheat.check.api.Check;
import dev.brighten.anticheat.check.api.CheckInfo;
import dev.brighten.anticheat.check.api.Event;
import dev.brighten.api.check.CheckType;
import lombok.val;
import org.bukkit.enchantments.Enchantment;
import org.bukkit.event.player.PlayerInteractEvent;

@CheckInfo(name = "BookEnchant", description = "Prevents the use of enchanted books.",
        checkType = CheckType.EXPLOIT, punishVL = 0, executable = false)
public class BookEnchant extends Check {

    @Event
    public void onEvent(PlayerInteractEvent event) {
        if(event.getItem() == null) return;

        val type = event.getItem().getType();

        if(type.name().contains("BOOK") && !type.name().contains("ENCHANT")
                && event.getItem().getEnchantments().size() > 0) {
            for (Enchantment enchantment : event.getItem().getEnchantments().keySet()) {
                event.getItem().removeEnchantment(enchantment);
            }
            event.setCancelled(true);
        }
    }
}
